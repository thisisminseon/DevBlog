<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<!-- Header fragment -->
<header th:fragment="header" class="header">
    <div class="header-inner">
        <a href="/hello" class="header-logo">Dev<span>Blog</span></a>

        <!-- Tag navigation -->
        <nav class="header-nav">
            <a th:each="tag : ${navTags}"
               th:href="@{/hello(tag=${tag.name})}"
               th:text="'#' + ${tag.name}"
               th:classappend="${#strings.equals(currentTag, tag.name)} ? 'active' : ''">
            </a>
        </nav>

        <!-- Actions -->
        <div class="header-actions">
            <button class="btn-search-toggle" onclick="toggleSearch()" title="検索">&#128269;</button>

            <!-- Not logged in -->
            <span sec:authorize="!isAuthenticated()">
                <a th:href="@{/auth/login}">ログイン</a>
            </span>

            <!-- Logged in -->
            <span sec:authorize="isAuthenticated()">
                <a th:href="@{/post/write}" class="btn btn-primary btn-sm">新規投稿</a>
                <a th:href="@{/mypage}">マイページ</a>
                <span sec:authorize="hasRole('ADMIN')">
                    <a th:href="@{/admin}">管理者</a>
                </span>
                <form th:action="@{/auth/logout}" method="post" style="display:inline;">
                    <button type="submit" class="btn btn-outline btn-sm">ログアウト</button>
                </form>
            </span>
        </div>
    </div>

    <!-- Search bar (hidden by default) -->
    <div id="searchBar" class="search-bar">
        <form th:action="@{/post/search}" method="get">
            <input type="text" name="keyword" placeholder="記事を検索..." required>
            <button type="submit" class="btn btn-primary">検索</button>
        </form>
    </div>
</header>

</html>
